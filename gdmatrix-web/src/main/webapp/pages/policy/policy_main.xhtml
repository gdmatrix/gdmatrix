<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sf="http://faces.santfeliu.org"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:gdm="http://gdmatrix.org/faces"
                xmlns:emcomp="http://xmlns.jcp.org/jsf/composite/emcomp">

  <div class="ui-fluid formgrid grid">

    <div class="field col-12 md:col-4">
      <p:outputLabel for="@next" value="PolicyId" />
      <p:inputText value="#{policyObjectBean.policy.policyId}" readonly="true" />
    </div>

    <div class="field col-12 md:col-8">
      <p:outputLabel for="@next" value="#{policyBundle.policyMain_type}" 
                     indicateRequired="true" />

      <emcomp:typeReference value="#{policyObjectBean.policy.policyTypeId}"
                            type="Policy"
                            showNonInstantiableItems="false"
                            styleClass="w-full"
                            scrollHeight="200"
                            queryDelay="1000"
                            minQueryLength="3"
                            required="#{not empty param['mainform:search_tabs:store']}"
                            requiredMessage="#{messageBundle.TYPE_MUST_BE_SELECTED}"
                            formSelector="#{policyObjectBean.formSelector}"
                            process="@form:cnt:search_tabs:tabs"
                            update="@form:cnt:search_tabs:tabs"
                            disabled="#{!policyObjectBean.editable}" />      
    </div>

    <div class="field col-12">
      <p:outputLabel for="@next" value="#{policyBundle.policyMain_title}" 
                     indicateRequired="true" />
      <p:inputText value="#{policyObjectBean.policy.title}" 
                   required="#{not empty param['mainform:search_tabs:store']}" 
                   requiredMessage="#{messageBundle.TITLE_IS_REQUIRED}" />
    </div>

    <div class="field col-12">
      <p:outputLabel for="@next" value="#{policyBundle.policyMain_description}" />
      <p:inputTextarea value="#{policyObjectBean.policy.description}" />
    </div>

    <emcomp:auditData creationUserId="#{policyObjectBean.policy.creationUserId}" 
                      creationDateTime="#{policyObjectBean.policy.creationDateTime}" 
                      changeUserId="#{policyObjectBean.policy.changeUserId}" 
                      changeDateTime="#{policyObjectBean.policy.changeDateTime}" />
    <!--
        <div class="w-12 font-bold surface-ground p-2 m-2">#{policyBundle.policyMain_activation}</div> 
    -->
    <div class="field col-12">
      <p:outputLabel for="@next" value="#{policyBundle.policyMain_date}" />
      <p:commandButton icon="pi pi-question-circle" styleClass="rounded-button ui-button-info ui-button-flat"
                       onclick="PF('helpDocumentDialog').show()"/>     
      <gdm:codemirror value="#{policyObjectBean.policy.activationDateExpression}" language="javascript"/>
    </div>

    <div class="field col-12">
      <p:outputLabel for="@next" value="#{policyBundle.policyMain_condition}" />
      <p:commandButton icon="pi pi-question-circle" styleClass="rounded-button ui-button-info ui-button-flat"
                       onclick="PF('helpDocumentDialog').show()"/>
      <gdm:codemirror value="#{policyObjectBean.policy.activationCondition}" language="javascript"/>
    </div>

    <!--
        <div class="w-12 font-bold surface-ground p-2 m-2">#{policyBundle.policyMain_execution}</div> 
    -->
    <div class="field col-12">
      <p:selectBooleanCheckbox value="#{policyObjectBean.policy.automaticExecution}"
                               itemLabel="#{policyBundle.policyMain_automatic}"
                               disabled="#{!policyObjectBean.editable}"/>     
    </div>    

  </div>

  <emcomp:dynamicProperties typeId="#{policyObjectBean.policy.policyTypeId}"
                            formSelector="#{policyObjectBean.formSelector}"
                            properties="#{policyObjectBean.policy.property}" 
                            options="#{dynamicPropertiesBean.getEditOptions('mainform:search_tabs:store')}"/> 

  <p:dialog id="help_document_dialog" widgetVar="helpDocumentDialog" 
            resizable="false" responsive="true" position="center center"
            minHeight="100" width="600" showEffect="fade" hideEffect="fade">
    
    <ui:include src="help.html" />

  </p:dialog>  

</ui:composition>
