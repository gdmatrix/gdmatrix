<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

  <script>
    function removeFocus()
    {
      document.activeElement.blur(); 
    }
  </script>
  
  <p:messages showSummary="true" styleClass="messages" 
              showIcon="true" closable="false" severity="error,fatal">
    <p:autoUpdate />
  </p:messages>        
  
  <p:schedule id="schedule" 
              rendered="#{eventFinderBean.renderSchedule}"
              value="#{eventFinderBean.eventModel}"
              widgetVar="schedule"
              timeZone="#{eventFinderBean.serverTimeZone}"
              clientTimeZone="#{eventFinderBean.serverTimeZone}"                       
              view="#{eventFinderBean.scheduleView}"
              initialDate="#{eventFinderBean.scheduleInitialDate}"
              tooltip="true">    
    <p:ajax event="dateSelect" listener="#{eventFinderBean.onDateSelect}" 
            process="@this"
            delay="500" />
    <p:ajax event="dateDblSelect" listener="#{eventFinderBean.onDateDblSelect}" 
            process="@this" 
            update="@form:cnt:search_tabs:obj_tabs @form:cnt:context_panel"            
            oncomplete="PF('objectTabs').select(0);PF('searchTabs').select(#{eventObjectBean.editModeSelector});removeFocus();" />        
    <p:ajax event="eventSelect" listener="#{eventFinderBean.onEventSelect}"            
            process="@this"
            update="@form:cnt:search_tabs:obj_tabs @form:cnt:context_panel"
            oncomplete="PF('objectTabs').select(0);PF('searchTabs').select(#{eventObjectBean.editModeSelector});removeFocus();" />
    <p:ajax event="eventMove" listener="#{eventFinderBean.onEventMove}"
            process="@this"
            update="@form:cnt:search_tabs:obj_tabs" />
    <p:ajax event="eventResize" listener="#{eventFinderBean.onEventResize}"
            process="@this"
            update="@form:cnt:search_tabs:obj_tabs" />
  </p:schedule>
  
  <h:outputText value="#{agendaBundle.insufficientFilter}"
                rendered="#{not eventFinderBean.renderSchedule}" 
                escape="false" />
  
</ui:composition>

