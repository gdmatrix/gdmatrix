<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:gdm="http://gdmatrix.org/faces"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:sf="http://faces.santfeliu.org">

  <h:panelGroup id="polygon_panel" layout="block"
                styleClass="sld_panel #{geoSldBean.isPanelExpanded(symbolizer) ? 'expanded' :''}" 
                rendered="#{symbolizer.symbolizerType == 'Polygon'}">

    <div class="sld_header">
      <p:commandButton action="#{geoSldBean.expandPanel(symbolizer)}"
                       process="@form:cnt" update="polygon_panel"
                       title="Expand" rendered="#{not geoSldBean.isPanelExpanded(symbolizer)}"
                       icon="pi pi-angle-right"
                       styleClass="rounded-button ui-button-flat"/>
      <p:commandButton action="#{geoSldBean.collapsePanel(symbolizer)}"
                       process="@form:cnt" update="polygon_panel"
                       title="Collapse" rendered="#{geoSldBean.isPanelExpanded(symbolizer)}"
                       icon="pi pi-angle-down"
                       styleClass="rounded-button ui-button-flat" />
      <span class="#{geoSldBean.getSymbolizerIcon(symbolizer)}"/><span class="ml-2 flex-grow-1 font-bold">PolygonSymbolizer</span>
      <p:menuButton icon="pi pi-cog" buttonStyleClass="rounded-button ui-button-flat">
        <p:menuitem value="Duplicate" action="#{symbolizer.duplicate}"
                       process="@form:cnt" update="@parent:@parent:@parent:@parent:rule_panel"
                       icon="pi pi-copy" />
        <p:menuitem value="Remove" action="#{symbolizer.remove}"
                       process="@form:cnt" update="@parent:@parent:@parent:@parent:rule_panel"
                       icon="pi pi-trash" />
      </p:menuButton>
    </div>

    <h:outputText value="#{geoSldBean.polygonSymbolizerSummary}" 
                  styleClass="summary" escape="false" 
                  rendered="#{not geoSldBean.isPanelExpanded(symbolizer)}" />    
    
    <h:panelGroup rendered="#{geoSldBean.isPanelExpanded(symbolizer)}">
      <div class="sld_field">
        <p:outputLabel value="Geometry:" for="@next" />
        <p:inputText value="#{symbolizer.geometryAsCql}" styleClass="code flex-grow-1 w-full"
                     onfocus="showCQLAssistant('namedLayer[#{geoSldBean.namedLayerIndex}]', this)"
                     onblur="hideCQLAssistant()" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeColor:" for="@next" />
        <p:colorPicker value="#{symbolizer.stroke.strokeColor}" alpha="false" styleClass="code w-10rem" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeWidth:" for="@next" />
        <p:inputText value="#{symbolizer.stroke.strokeWidth}" styleClass="code" inputmode="number" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeOpacity:" for="@next" />
        <p:inputText value="#{symbolizer.stroke.strokeOpacity}" styleClass="code" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeLineJoin:" for="@next" />
        <p:selectOneMenu value="#{symbolizer.stroke.strokeLineJoin}">
          <f:selectItem itemLabel=" " itemValue="" />
          <f:selectItem itemLabel="mitre" itemValue="mitre" />
          <f:selectItem itemLabel="round" itemValue="round" />
          <f:selectItem itemLabel="bevel" itemValue="bevel" />
        </p:selectOneMenu>
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeLineCap:" for="@next" />
        <p:selectOneMenu value="#{symbolizer.stroke.strokeLineCap}">
          <f:selectItem itemLabel=" " itemValue="" />
          <f:selectItem itemLabel="butt" itemValue="butt" />
          <f:selectItem itemLabel="round" itemValue="round" />
          <f:selectItem itemLabel="square" itemValue="square" />
        </p:selectOneMenu>
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeDashArray:" for="@next" />
        <p:inputText value="#{symbolizer.stroke.strokeDashArray}" styleClass="code" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="StrokeDashOffset:" for="@next" />
        <p:inputText value="#{symbolizer.stroke.strokeDashOffset}" styleClass="code" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="FillColor:" for="@next" />
        <p:colorPicker value="#{symbolizer.fill.fillColor}" alpha="false" styleClass="code w-10rem" />
      </div>
      <div class="sld_field">
        <p:outputLabel value="FillOpacity:" for="@next" />
        <p:inputText value="#{symbolizer.fill.fillOpacity}" styleClass="code" />
      </div>
    </h:panelGroup>
  </h:panelGroup>

</ui:composition>