<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sf="http://faces.santfeliu.org"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <h:outputStylesheet library="css" name="object_3col.css" />

    <p:button onclick="return showPanel('leftPanel');"
              icon="pi pi-search"
              widgetVar="leftPanelButton"
              class="side_button left first_time"  />

    <p:button onclick="return showPanel('rightPanel')"
              icon="pi pi-sitemap"
              widgetVar="rightPanelButton"
              class="side_button right first_time" />

    <div class="template-layout flex h-full">

      <div class="col flex slick-columns w-full pl-0 pr-0">
        <!-- Left column -->
        <p:panel id="left_colunn"
                 widgetVar="leftPanel"
                 class="side_panel left m-1 first_time">
          <f:facet name="header">
            <i class="pi pi-search m-1"></i>
            <p:outputLabel value="#{objectBundle.search}" />
            <p:commandLink onclick="return closePanel('leftPanel');"
                           class="ui-panel-titlebar-icon ui-corner-all ui-state-default">
              <span class="ui-icon ui-icon-closethick"></span>
            </p:commandLink>
          </f:facet>

          <ui:insert name="filter"></ui:insert>

        </p:panel>

        <!-- Central column -->
        <p:outputPanel id="central_column"
                       class="central_column flex-grow-1 m-1">          
          <h1 class="object_label" style="color:var(--text-color)">
            <h:outputText value="" styleClass="#{userSessionBean.menuModel.selectedMenuItem.properties.icon}" />
            <h:outputText value="#{userSessionBean.menuModel.selectedMenuItem.properties.label}" styleClass="ml-2" />
          </h1>
          <ui:insert name="object"></ui:insert>
        </p:outputPanel>

        <!-- Right column -->
        <p:panel id="right_column"
                 widgetVar="rightPanel"
                 class="side_panel right m-1 first_time">
          <f:facet name="header">
            <i class="pi pi-sitemap m-1"></i>
            <span>#{objectBundle.context}</span>
            <p:commandLink onclick="return closePanel('rightPanel');"
                           class="ui-panel-titlebar-icon ui-corner-all ui-state-default">
              <span class="ui-icon ui-icon-closethick"></span>
            </p:commandLink>
          </f:facet>

          <p:outputPanel id="context_panel">
            <p:tabView styleClass="context_tabs"
                       dynamic="true"
                       activeIndex="#{navigatorBean.contextTabSelector}">

              <p:ajax event="tabChange" process="@this" />

              <c:forEach items="#{navigatorBean.contextPanels}" var="contextPanel" >
                <ui:include src="/pages/obj/#{contextPanel}.xhtml" />
              </c:forEach>
            </p:tabView>
          </p:outputPanel>
        </p:panel>
      </div>

      <script>
        function showPanel(panelVar)
        {
          var panel = PF(panelVar);
          var panelButton = PF(panelVar + "Button");
          panel.show();
          panel.getJQ().removeClass("first_time");
          panelButton.getJQ().removeClass("first_time");
          panelButton.getJQ().css("display", "none");
          return false;
        }

        function closePanel(panelVar)
        {
          var panel = PF(panelVar);
          var panelButton = PF(panelVar + "Button");
          panel.close();
          panelButton.getJQ().css("display", "block");
          return false;
        }

        function endPanel(panelVar)
        {
          if (700 > window.innerWidth)
          {
            closePanel(panelVar);
          }
        }
      </script>

    </div>

    <p:growl id="growl">
      <p:autoUpdate />
    </p:growl>          
    
</ui:composition>



