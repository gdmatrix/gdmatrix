<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sf="http://faces.santfeliu.org"
                template="address_common.xhtml">

  <ui:param name="objectPage" value="object" />
  <ui:param name="updateOnStore" value="form_panel object_header favorites_table basic_results_table" />  

  <ui:define name="content">
    <f:loadBundle basename="org.santfeliu.kernel.web.resources.KernelBundle"
                  var="kernelBundle" />

    <h:panelGroup>

      <div class="ui-fluid formgrid grid">  

        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.address_type}" />

          <p:selectOneMenu id="personTypeId" value="#{addressMainBacking.address.addressTypeId}"  
                           styleClass="inputfield w-full"
                           filter="true" var="t">
            <f:selectItems value="#{addressMainBacking.typedHelper.allTypes}" var="type" 
                           itemLabel="#{type.description}" itemValue="#{type.typeId}" />
            <p:column>
              <h:outputText value="#{typeBean.getDescription(t)}" />
            </p:column>            
          </p:selectOneMenu>          
        </div> 

        <div class="field col-12 md:col-8">
          <p:outputLabel for="@next" value="#{kernelBundle.street}"  />
          <div class="ui-inputgroup">
            <p:commandButton icon="pi pi-search" oncomplete="PF('countryToStreetDialog').show()"
                             styleClass="ui-button-raised" 
                             action="#{countryToStreetBacking.showStreet(addressMainBacking.address.streetId)}"
                             alt="#{objectBundle.search}" title="#{objectBundle.search}"
                             ajax="true" update="placePickerPanel" />    
            <p:autoComplete id="street"
                            value="#{addressMainBacking.streetSelectItem}" 
                            maxResults="10" dropdown="true" dropdownMode="blank"
                            completeMethod="#{addressMainBacking.completeStreet}"
                            converter="selectItemConverter"
                            var="item" itemValue="#{item}" itemLabel="#{item.label}"
                            minQueryLength="3" queryDelay="1000"
                            onclick="this.setSelectionRange(0, this.value.length)">
              <p:ajax event="clear" listener="#{addressMainBacking.onStreetClear}" update="@this" />              
              <p:column>                 
                <h:outputText value="#{item.label} (#{item.value})" />
              </p:column>        
            </p:autoComplete>  
          </div>
        </div>   


        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="Km" />
          <p:inputText id="km" value="#{addressMainBacking.address.km}" 
                       styleClass="inputfield w-full"/>
        </div> 

        <div class="field col-8 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.address_number} 1" />
          <p:inputText id="number1" value="#{addressMainBacking.address.number1}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-4 md:col-1">          
          <p:outputLabel for="@next" value="#{kernelBundle.address_bis}" />
          <p:inputText id="bis1" value="#{addressMainBacking.address.bis1}" 
                       styleClass="inputfield w-full"/>          
        </div>  

        <div class="field col-8 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.address_number} 2" />
          <p:inputText id="number2" value="#{addressMainBacking.address.number2}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-4 md:col-1">            
          <p:outputLabel for="@next" value="#{kernelBundle.address_bis}" />
          <p:inputText id="bis2" value="#{addressMainBacking.address.bis2}" 
                       styleClass="inputfield w-full"/>          
        </div> 


        <div class="field col-12 md:col-1">
          <p:outputLabel for="@next" value="#{kernelBundle.address_block}" />
          <p:inputText id="block" value="#{addressMainBacking.address.block}" 
                       styleClass="inputfield w-full"/>
        </div> 

        <div class="field col-12 md:col-1">          
          <p:outputLabel for="@next" value="#{kernelBundle.address_entrance_hall}" />
          <p:inputText id="entranceHall" value="#{addressMainBacking.address.entranceHall}" 
                       styleClass="inputfield w-full"/>    
        </div> 

        <div class="field col-12 md:col-1">          
          <p:outputLabel for="@next" value="#{kernelBundle.address_stair}" />
          <p:inputText id="stair" value="#{addressMainBacking.address.stair}" 
                       styleClass="inputfield w-full"/>             
        </div> 

        <div class="field col-12 md:col-1">
          <p:outputLabel for="@next" value="#{kernelBundle.address_floor}" />
          <p:inputText id="floor" value="#{addressMainBacking.address.floor}" 
                       styleClass="inputfield w-full"/>
        </div> 

        <div class="field col-12 md:col-1">          
          <p:outputLabel for="@next" value="#{kernelBundle.address_door}" />
          <p:inputText id="door" value="#{addressMainBacking.address.door}" 
                       styleClass="inputfield w-full"/>          
        </div> 

        <div class="field col-12 md:col-3">
          <p:outputLabel for="@next" value="#{kernelBundle.address_postal_code}" />
          <p:inputText id="postalCode" value="#{addressMainBacking.address.postalCode}" 
                       styleClass="inputfield w-full"/>
        </div> 

        <div class="field col-12 md:col-3">          
          <p:outputLabel for="@next" value="#{kernelBundle.address_post_office_box}" />
          <p:inputText id="postOfficeBox" value="#{addressMainBacking.address.postOfficeBox}" 
                       styleClass="inputfield w-full"/>          
        </div> 

        <div class="field col-12 md:col-3">
          <p:outputLabel for="@next" value="#{kernelBundle.address_gis_reference}" />
          <p:inputText id="gisReference" value="#{addressMainBacking.address.gisReference}" 
                       styleClass="inputfield w-full"/>
        </div> 

        <div class="field col-12">
          <p:outputLabel for="@next" value="#{kernelBundle.address_comments}" />
          <p:inputText id="comments" value="#{addressMainBacking.address.comments}" 
                       styleClass="inputfield w-full"/>
        </div> 

      </div>   

      <p:dialog id="countryToStreetDialog" dynamic="true"  modal="true" 
                widgetVar="countryToStreetDialog" styleClass="w-6"
                appendTo="@(form)">

        <ui:include src="country_to_street.xhtml" />

        <div class="text-right pt-3">
          <p:commandButton value="#{objectBundle.select}" 
                           icon="pi pi-check"
                           oncomplete="PF('countryToStreetDialog').hide()" 
                           action="#{addressMainBacking.selectStreet(countryToStreetBacking.streetId)}"
                           update="street" styleClass="ui-button-raised m-1"/> 
          <p:commandButton value="#{objectBundle.close}" 
                           icon="pi pi-times"
                           onclick="PF('countryToStreetDialog').hide()" styleClass="ui-button-raised m-1"
                           global="false"/>
        </div>

      </p:dialog>   

    </h:panelGroup>



  </ui:define>

</ui:composition>
