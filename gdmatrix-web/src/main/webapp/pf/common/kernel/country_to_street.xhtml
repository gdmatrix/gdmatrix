<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

  <f:loadBundle basename="org.santfeliu.kernel.web.resources.KernelBundle"
                var="kernelBundle" />
    
  <p:panel id="placePickerPanel" header="#{kernelBundle.country_to_street_search}" styleClass="mb-2">

    <div class="formgrid grid">  

      <div class="field col-12 flex flex-wrap">
        <p:outputLabel for="@next" value="#{kernelBundle.country}" styleClass="w-full" />
        <p:selectOneMenu id="countrySelector" value="#{countryToStreetBacking.countryId}"
                         styleClass="inputfield w-10" filter="true" 
                         >
          <p:ajax listener="#{countryToStreetBacking.onCountryChange}" update="placePickerPanel"/>
          <f:selectItem itemLabel="" itemValue="" noSelectionOption="true"/>
          <f:selectItems value="#{countryToStreetBacking.countrySelectItems}" />
        </p:selectOneMenu>

        <p:outputPanel rendered="#{countryToStreetBacking.adminUser}">
          <p:commandButton
            icon="pi pi-plus-circle"
            alt="#{objectBundle.add}" title="#{objectBundle.add}"
            action="#{countryToStreetBacking.addCountry}" 
            ajax="true" update="editingPanels"
            styleClass="ui-button-raised vertical-align-middle ml-1"
            />

          <p:commandButton rendered="#{countryToStreetBacking.countryId != null}"
                           icon="pi pi-pencil"
                           alt="#{objectBundle.edit}" title="#{objectBundle.edit}"
                           action="#{countryToStreetBacking.editCountry}" 
                           ajax="true" update="editingPanels" process="@this"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           global="false"/>

          <p:commandButton rendered="#{countryToStreetBacking.countryId != null}"       
                           icon="pi pi-trash"
                           alt="#{objectBundle.delete}" title="#{objectBundle.delete}"
                           action="#{countryToStreetBacking.deleteCountry}"
                           onclick="return confirm('#{objectBundle.confirm_remove}')"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           /> 
        </p:outputPanel>
      </div>

      <div class="field col-12 flex flex-wrap">
        <p:outputLabel for="@next" value="#{kernelBundle.province}"  styleClass="w-full"/>
        <p:selectOneMenu id="provinceSelector" value="#{countryToStreetBacking.provinceId}" 
                         styleClass="inputfield w-10" filter="true">
          <p:ajax listener="#{countryToStreetBacking.onProvinceChange}" update="placePickerPanel"/>
          <f:selectItem itemLabel="" itemValue="" noSelectionOption="true"/>              
          <f:selectItems value="#{countryToStreetBacking.provinceSelectItems}"/>
        </p:selectOneMenu>

        <p:outputPanel rendered="#{countryToStreetBacking.adminUser}">
          <p:commandButton rendered="#{countryToStreetBacking.countryId != null}"
                           icon="pi pi-plus-circle"
                           alt="#{objectBundle.add}" title="#{objectBundle.add}"
                           action="#{countryToStreetBacking.addProvince}" 
                           ajax="true" update="editingPanels"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           />
          <p:commandButton rendered="#{countryToStreetBacking.provinceId != null}"
                           icon="pi pi-pencil"
                           alt="#{objectBundle.edit}" title="#{objectBundle.edit}"
                           action="#{countryToStreetBacking.editProvince}" 
                           ajax="true" update="editingPanels"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           global="false"
                           />
          <p:commandButton rendered="#{countryToStreetBacking.provinceId != null}"       
                           icon="pi pi-trash"
                           alt="#{objectBundle.delete}" title="#{objectBundle.delete}"
                           action="#{countryToStreetBacking.deleteProvince}"
                           onclick="return confirm('#{objectBundle.confirm_remove}')"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           />    
        </p:outputPanel>
      </div> 

      <div class="field col-12 flex flex-wrap">
        <p:outputLabel for="@next" value="#{kernelBundle.city}"  styleClass="w-full"/>
        <p:selectOneMenu id="citySelector" value="#{countryToStreetBacking.cityId}" 
                         styleClass="inputfield w-10" filter="true">
          <p:ajax listener="#{countryToStreetBacking.onCityChange}" update="placePickerPanel"/>
          <f:selectItem itemLabel="" itemValue="" noSelectionOption="true"/>              
          <f:selectItems value="#{countryToStreetBacking.citySelectItems}"/>
        </p:selectOneMenu>
        <p:outputPanel rendered="#{countryToStreetBacking.adminUser}">
          <p:commandButton rendered="#{countryToStreetBacking.provinceId != null}"
                           icon="pi pi-plus-circle"
                           alt="#{objectBundle.add}" title="#{objectBundle.add}"
                           action="#{countryToStreetBacking.addCity}" process="@this"
                           ajax="true" update="editingPanels"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           />
          <p:commandButton rendered="#{countryToStreetBacking.cityId != null}"
                           icon="pi pi-pencil"
                           alt="#{objectBundle.edit}" title="#{objectBundle.edit}"
                           action="#{countryToStreetBacking.editCity}" process="@this"
                           ajax="true" update="editingPanels"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           global="false"
                           />
          <p:commandButton rendered="#{countryToStreetBacking.cityId != null}"       
                           icon="pi pi-trash"
                           alt="#{objectBundle.delete}" title="#{objectBundle.delete}"
                           action="#{countryToStreetBacking.deleteCity}"
                           onclick="return confirm('#{objectBundle.confirm_remove}')"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           />   
        </p:outputPanel>
      </div>   

      <div class="field col-12 flex flex-wrap">
        <p:outputLabel for="@next" value="#{kernelBundle.street}" styleClass="w-full"/>
        <p:selectOneMenu id="streetSelector" value="#{countryToStreetBacking.streetId}" 
                         styleClass="inputfield w-10" filter="true">
          <f:selectItem itemLabel="" itemValue="" noSelectionOption="true"/>              
          <f:selectItems value="#{countryToStreetBacking.streetSelectItems}"/>
        </p:selectOneMenu>

        <p:outputPanel rendered="#{countryToStreetBacking.adminUser}">
          <p:commandButton rendered="#{countryToStreetBacking.cityId != null}"
                           icon="pi pi-plus-circle"
                           alt="#{objectBundle.add}" title="#{objectBundle.add}"
                           action="#{countryToStreetBacking.addStreet}" process="@this"
                           ajax="true" update="editingPanels"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           />
          <p:commandButton rendered="#{countryToStreetBacking.streetId != null}"
                           icon="pi pi-pencil"
                           alt="#{objectBundle.edit}" title="#{objectBundle.edit}"
                           action="#{countryToStreetBacking.editStreet}" process="@this"
                           ajax="true" update="editingPanels"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           global="false"
                           />
          <p:commandButton rendered="#{countryToStreetBacking.streetId != null}"       
                           icon="pi pi-trash"
                           alt="#{objectBundle.delete}" title="#{objectBundle.delete}"
                           action="#{countryToStreetBacking.deleteStreet}"
                           onclick="return confirm('#{objectBundle.confirm_remove}')"
                           styleClass="ui-button-raised vertical-align-middle ml-1"
                           /> 
        </p:outputPanel>        
      </div>    

    </div>



  </p:panel> 

  <p:outputPanel id="editingPanels" >

    <p:panel id="editingCountryPanel" header="#{kernelBundle.country} #{countryToStreetBacking.country.countryId}"
             rendered="#{countryToStreetBacking.countryEditing}">

      <div class="formgrid grid pl-2">        
        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.country}" />
          <p:inputText id="countryName" value="#{countryToStreetBacking.country.name}" 
                       styleClass="inputfield w-full"/>
        </div>     

        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="ISO Code" />
          <p:inputText id="isoCode" value="#{countryToStreetBacking.country.ISOCode}" 
                       styleClass="inputfield w-full"/>
        </div>

        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="Language" />
          <p:inputText id="language" value="#{countryToStreetBacking.country.language}" 
                       styleClass="inputfield w-full"/>
        </div>      
      </div> 



    </p:panel>   

    <p:panel id="editingProvincePanel" header="#{kernelBundle.province} #{countryToStreetBacking.province.provinceId}"
             rendered="#{countryToStreetBacking.provinceEditing}"> 
      <div class="formgrid grid pl-2">        
        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.province}" />
          <p:inputText id="provinceName" value="#{countryToStreetBacking.province.name}" 
                       styleClass="inputfield w-full"/>
        </div>   
      </div>
    </p:panel>    

    <p:panel id="editingCityPanel" header="#{kernelBundle.city} #{countryToStreetBacking.city.cityId}" 
             rendered="#{countryToStreetBacking.cityEditing}"> 
      <div class="formgrid grid pl-2">        
        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.city}" />
          <p:inputText id="cityName" value="#{countryToStreetBacking.city.name}" 
                       styleClass="inputfield w-full"/>
        </div>   
      </div>    
    </p:panel>

    <p:panel id="editingStreetPanel" header="#{kernelBundle.street} #{countryToStreetBacking.street.streetId}" 
             rendered="#{countryToStreetBacking.streetEditing}"> 

      <div class="formgrid grid pl-2">        
        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.street_type}" />
          <p:inputText id="streetTypeId" value="#{countryToStreetBacking.street.streetTypeId}" 
                       styleClass="inputfield w-full"/>
        </div>     

        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.person_particle}" />
          <p:inputText id="streetParticle" value="#{countryToStreetBacking.street.particle}" 
                       styleClass="inputfield w-full"/>
        </div>

        <div class="field col-12 md:col-6">
          <p:outputLabel for="@next" value="#{kernelBundle.street_name}" />
          <p:inputText id="streetName" value="#{countryToStreetBacking.street.name}" 
                       styleClass="inputfield w-full"/>
        </div>    
      </div>     
    </p:panel>

    <p:outputPanel class="text-right pt-3" rendered="#{countryToStreetBacking.countryEditing or
                                                       countryToStreetBacking.provinceEditing or
                                                       countryToStreetBacking.cityEditing or 
                                                       countryToStreetBacking.streetEditing}">

      <p:commandButton value="#{objectBundle.store}" 
                       icon="pi pi-check"
                       action="#{countryToStreetBacking.store}"
                       ajax="true" update="object_header editingPanels placePickerPanel" process="@form @this"
                       styleClass="ui-button-raised m-1"/> 
      <p:commandButton value="#{objectBundle.close}" 
                       icon="pi pi-times"
                       action="#{countryToStreetBacking.cancel}"
                       ajax="true" update="editingPanels" process="@this"
                       styleClass="ui-button-raised m-1"
                       global="false"/>
    </p:outputPanel>    

  </p:outputPanel>
</ui:composition>