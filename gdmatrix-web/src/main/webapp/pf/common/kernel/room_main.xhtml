<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sf="http://faces.santfeliu.org"
                template="room_common.xhtml">

  <ui:param name="objectPage" value="object" />
  <ui:param name="updateOnStore" value="form_panel object_header favorites_table basic_results_table" />  

  <ui:define name="content">
    <f:loadBundle basename="org.santfeliu.kernel.web.resources.KernelBundle"
                  var="kernelBundle" />

    <h:panelGroup>

      <div class="ui-fluid formgrid grid">  

        <div class="field col-12">
          <p:outputLabel for="@next" value="#{kernelBundle.room_name}" />
          <p:inputText id="name" value="#{roomMainBacking.room.name}" 
                       styleClass="inputfield w-full"/>
        </div>        
        
        <div class="field col-12 md:col-6">
          <p:outputLabel for="@next" value="#{kernelBundle.room_type}" />
          <p:selectOneMenu id="roomTypeId" value="#{roomMainBacking.room.roomTypeId}"  
                           styleClass="inputfield w-full"
                           filter="true" var="t">
            <f:selectItems value="#{roomMainBacking.typedHelper.allTypes}" var="type" 
                           itemLabel="#{type.description}" itemValue="#{type.typeId}" />
            <p:column>
              <h:outputText value="#{typeBean.getDescription(t)}" />
            </p:column>            
          </p:selectOneMenu>
        </div> 

        <div class="field col-12 md:col-6">
          <p:outputLabel for="@next" value="#{roomMainBacking.typedHelper.getPropertyLabel('address', kernelBundle.room_address)}" />
          <div class="ui-inputgroup">                 
            <p:commandButton action="#{roomMainBacking.search('Address', '#{roomMainBacking.selectedAddress}')}"
                             icon="pi pi-search" ajax="false"
                             styleClass="ui-button-raised"                               
                             alt="#{objectBundle.search}" title="#{objectBundle.search}"
                             update="@form" /> 
            <p:autoComplete id="address" styleClass="inputfield w-11" inputStyleClass="w-10"
                            value="#{roomMainBacking.addressSelectItem}" 
                            maxResults="10" dropdown="true" dropdownMode="blank"
                            completeMethod="#{roomMainBacking.completeAddress}"
                            converter="selectItemConverter"
                            var="item" itemValue="#{item}" itemLabel="#{item.label}"
                            minQueryLength="3" queryDelay="1000"
                            onclick="this.setSelectionRange(0, this.value.length)">
              <p:ajax event="itemSelect" listener="#{roomMainBacking.onAddressSelect}" update="@this"/>
              <p:ajax event="clear" listener="#{roomMainBacking.onAddressClear}" update="@this"/>              
              <p:column>
                <h:outputText value="#{item.label} (#{item.value})" />
              </p:column>        
            </p:autoComplete>           
          </div>
        </div>                

        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.room_phone}" />
          <p:inputText id="phone" value="#{roomMainBacking.room.phone}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.room_fax}" />
          <p:inputText id="fax" value="#{roomMainBacking.room.fax}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-12 md:col-4">
          <p:outputLabel for="@next" value="#{kernelBundle.room_email}" />
          <p:inputText id="email" value="#{roomMainBacking.room.email}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.room_capacity}" />
          <p:inputText id="capacity" value="#{roomMainBacking.room.capacity}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.room_area}" />
          <p:inputText id="area" value="#{roomMainBacking.room.area}" 
                       styleClass="inputfield w-full"/>
        </div>          
        
        <div class="field col-12 md:col-6">
          <p:outputLabel for="@next" value="#{kernelBundle.room_schedule}" />
          <p:inputText id="schedule" value="#{roomMainBacking.room.schedule}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-12 md:col-2">
          <p:outputLabel for="@next" value="#{kernelBundle.room_spaceId}" />
          <p:inputText id="spaceId" value="#{roomMainBacking.room.spaceId}" 
                       styleClass="inputfield w-full"/>
        </div>  

        <div class="field col-12">
          <p:outputLabel for="@next" value="#{kernelBundle.room_comments}" />
          <p:inputText id="comments" value="#{roomMainBacking.room.comments}" 
                       styleClass="inputfield w-full"/>
        </div> 

      </div>   

      <p:dialog id="addressDialog" dynamic="true"  modal="true" 
                widgetVar="addressDialog" styleClass="w-6"
                appendTo="@(form)">

        <ui:include src="country_to_street.xhtml" />

        <div class="text-right pt-3">
          <p:commandButton value="#{objectBundle.select}" 
                           icon="pi pi-check"
                           oncomplete="PF('countryToStreetDialog').hide()" 
                           action="#{addressMainBacking.selectStreet(countryToStreetBacking.streetId)}"
                           update="street" styleClass="ui-button-raised m-1"/> 
          <p:commandButton value="#{objectBundle.close}" 
                           icon="pi pi-times"
                           onclick="PF('countryToStreetDialog').hide()" styleClass="ui-button-raised m-1"
                           global="false"/>
        </div>

      </p:dialog>   

    </h:panelGroup>



  </ui:define>

</ui:composition>
