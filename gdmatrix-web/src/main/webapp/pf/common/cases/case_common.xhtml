<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pf/common/obj/#{objectPage}.xhtml">
  
  <ui:define name="advanced_filter">
    <f:loadBundle basename="org.santfeliu.cases.web.resources.CaseBundle" 
                  var="caseBundle" />    
    <!-- CaseId -->
    <p:outputPanel styleClass="field">
      <p:outputLabel for="@next" value="#{caseBundle.case_caseId}" />
      <p:chips id="caseId" value="#{caseSearchBacking.caseId}"
               addOnPaste="true" separator=","
               class="inputfield w-full ui-fluid"/>
    </p:outputPanel>
    
    <!-- TypeId -->
    <p:outputPanel styleClass="field"
                   rendered="#{!caseSearchBacking.typedHelper.isPropertyHidden('caseTypeId') and caseSearchBacking.typedHelper.allTypes.size() > 1}">
      <p:outputLabel for="@next" value="#{caseSearchBacking.typedHelper.getPropertyLabel('caseTypeId', caseBundle.case_type)}" />    
      <p:selectOneMenu id="typeId" value="#{caseSearchBacking.filter.caseTypeId}"  
                       styleClass="inputfield w-full" filter="true" var="t">
        <f:selectItems value="#{caseSearchBacking.typedHelper.allTypes}" 
                       var="type" itemLabel="#{type.description}" 
                       itemValue="#{type.typeId}" />
        <p:column style="width:30%">
          <h:outputText value="#{t}" />
        </p:column>
        <p:column style="width:70%">
          <h:outputText value="#{typeBean.getDescription(t)}" />
        </p:column>            
      </p:selectOneMenu>
    </p:outputPanel>     

    <!-- Title -->
    <p:outputPanel styleClass="field" rendered="#{!caseSearchBacking.typedHelper.isPropertyHidden('title')}">
      <p:outputLabel for="@next" value="#{caseSearchBacking.typedHelper.getPropertyLabel('title', caseBundle.case_title)}" />        
      <p:inputText id="title" value="#{caseSearchBacking.filter.title}" 
                   class="inputfield w-full" />
    </p:outputPanel>  

    <!-- Description -->
    <p:outputPanel styleClass="field" rendered="#{!caseSearchBacking.typedHelper.isPropertyHidden('description')}">
      <p:outputLabel for="@next" value="#{caseSearchBacking.typedHelper.getPropertyLabel('description', caseBundle.case_description)}" />        
      <p:inputText id="description" value="#{caseSearchBacking.filter.description}" 
                   class="inputfield w-full" />
    </p:outputPanel>  

    <!-- Dates -->
    <p:fieldset legend="#{caseSearchBacking.typedHelper.getPropertyLabel('date', caseBundle.caseSearch_date)}" 
                toggleable="true">
      <p:outputPanel styleClass="formgrid grid">

        <p:outputPanel styleClass="field col-12">   
          <p:selectOneMenu id="dateComparator" value="#{caseSearchBacking.filter.dateComparator}"
                           styleClass="inputfield w-full" style="vertical-align:middle">
            <f:selectItem itemLabel=" " itemValue="0" />
            <f:selectItem itemLabel="#{caseBundle.case_startDate}" itemValue="1" />
            <f:selectItem itemLabel="#{caseBundle.case_endDate}" itemValue="2" />
            <f:selectItem itemLabel="#{caseBundle.caseSearch_activeDate}" itemValue="3" />
          </p:selectOneMenu>      
        </p:outputPanel>

        <div class="field col-12 md:col-6">
          <p:outputLabel for="@next" value=" #{caseBundle.caseSearch_between} " />
          <p:datePicker id="start_date" value="#{caseSearchBacking.fromDate}" 
                        locale="#{caseSearchBacking.language}" inputStyleClass="w-12"
                        styleClass="inputfield w-full" showIcon="false" 
                        monthNavigator="true" yearNavigator="true" />  
        </div>
        <div class="field col-12 md:col-6">
          <p:outputLabel for="@next" value=" #{caseBundle.caseSearch_and} " />
          <p:datePicker id="end_date" value="#{caseSearchBacking.toDate}" 
                        locale="#{caseSearchBacking.language}" inputStyleClass="w-12"
                        styleClass="inputfield w-full" showIcon="false" 
                        monthNavigator="true" yearNavigator="true" />  
        </div>
      </p:outputPanel>      
    </p:fieldset>
    
    <!-- searchExpression -->
    <p:outputPanel styleClass="field" rendered="#{caseSearchBacking.typedHelper.render('searchExpression')}">
      <p:outputLabel for="@next" value="#{caseBundle.case_searchExpression}:" />
      <p:inputText id="searchExpression" value="#{caseSearchBacking.filter.searchExpression}"
                   styleClass="inputfield w-full"/>
    </p:outputPanel>    
    
<!--
    <ui:include src="/pf/common/obj/object_form.xhtml">
      <ui:param name="backing" value="#{caseSearchBacking}" />
    </ui:include>
-->
    
    <div class="buttons text-right">
      <p:commandButton value="#{objectBundle.clear}"
                       ajax="#{ajax}"
                       action="#{caseSearchBacking.clear}"
                       styleClass="ui-button-raised m-1"
                       update="search_accordion"/>      
      <p:commandButton value="#{objectBundle.search}"
                       action="#{caseSearchBacking.search}"
                       ajax="true" process="@parent" update="#{objectPage == 'object_search' ? ':mainform:search_results_panel' :''}"
                       styleClass="ui-button-raised m-1" 
                       oncomplete="clickSlickDot(2)"/>
    </div>              
  </ui:define>          


</ui:composition>
