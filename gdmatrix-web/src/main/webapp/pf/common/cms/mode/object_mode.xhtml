<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sf="http://faces.santfeliu.org"
                xmlns:t="http://myfaces.apache.org/tomahawk">



  <div id="propertiesLayer" style="overflow:auto;width:100%;">

    <div>
      <p:tabView id="formTabs">
        <p:tab title="Propietats comunes">
          <ui:include src="/pf/common/cms/mode/common_edit.xhtml" />
        </p:tab>

        <p:tab title="Plantilla: #{nodeEditBacking.selectedTemplate}">
          <ui:include src="/pf/common/cms/mode/template_edit.xhtml" />                
        </p:tab>

        <p:tab title="Objecte: #{nodeEditBacking.selectedObject}">
          <ui:include src="/pf/common/cms/mode/objs/person.xhtml" />
        </p:tab>
      </p:tabView>
    </div>

    <h:panelGroup>
      <h:outputLabel value="#{tab}" />
      <p:dataTable id="tabs" var="tab" value="#{tabsEditBacking.tabs}" editable="true" editMode="cell" widgetVar="cellCars">      
        <p:column headerText="Name" style="width:10%"  >
          <h:outputText value="#{tab.name}" styleClass="propertyName" />
        </p:column>

        <p:column headerText="Label"  style="width:30%">
          <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{tab.label}" styleClass="propertyName"/></f:facet>
            <f:facet name="input"><p:inputText value="#{tab.label}" style="width:96%" label="Year" styleClass="propertyValue"/></f:facet>
          </p:cellEditor>
        </p:column>   

        <p:column headerText="Action"  style="width:45%">
          <p:cellEditor>
            <f:facet name="output"><h:outputText value="#{tab.outcome}" styleClass="propertyName" /></f:facet>
            <f:facet name="input">
              <p:selectOneMenu  value="#{tab.outcome}">
                <f:selectItem itemLabel=" " itemValue=" "/>
                <f:selectItems value="#{tabsEditBacking.pageBackings}" />
              </p:selectOneMenu>              
            </f:facet>
          </p:cellEditor>
        </p:column>

        <p:column   style="width:15%">
          <p:commandButton value="Delete" styleClass="ui-priority-primary" process="@this" 
                           update="tabs mainform:pTabs mainform:msgs mainform:growl"
                           action="#{tabsEditBacking.onDeleteRow(tab)}" ajax="true"/>          
        </p:column>
      </p:dataTable>

      <p:tabView id="pTabs" value="#{tabsEditBacking.tabs}" var="pTab">
        <p:tab title="#{pTab.label}">
          <h:dataTable var="prop" value="#{pTab.properties}">
            <p:column><h:outputText value="#{prop.name}" /></p:column>
            <p:column><p:inputText value="#{prop.value}" /></p:column>
          </h:dataTable>           
        </p:tab>    
      </p:tabView>  

      <p:commandButton value="Add" styleClass="ui-priority-primary" process="@this" update="msgs tabs growl pTabs"
                       action="#{tabsEditBacking.onAddNew}" ajax="true"/>
      <p:commandButton value="Save" styleClass="ui-priority-primary" process="@this pTabs" update="msgs tabs growl pTabs"
                       action="#{tabsEditBacking.save}" ajax="true"/>               
    </h:panelGroup>
  </div>

</ui:composition>

