<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sf="http://faces.santfeliu.org"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/frames/#{userSessionBean.frame}/frame.xhtml">

  <ui:define name="template">

    <p:growl id="growl">
      <p:autoUpdate />
    </p:growl>

    <p:messages closable="true">
      <p:autoUpdate />
    </p:messages>

    <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()"/>

    <p:dialog widgetVar="statusDialog" modal="true" draggable="false" 
              closable="false" resizable="false" showHeader="false"
              styleClass="loading-icon-container">
      <div class="p-text-center">
        <i class="pi pi-spin pi-spinner loading-icon" aria-hidden="true"></i>
      </div>
    </p:dialog>

    <!-- Horizontal menu -->
    <p:outputPanel id="horizontal_menu">       
      <p:menubar id="horizontal_menubar" model="#{templateBacking.PFMenuModel}" class="menubar">            
        <f:facet name="options">
          <div class="flex justify-content-end align-items-center">
            <sf:languageSelector locales="#{userSessionBean.supportedLocales}"
                                 styleClass="m-2"/>                
            <p:outputLabel id="username_label" value="#{userSessionBean.displayName}" class="ml-4 mr-2"/>
            <p:tooltip for="username_label">
              <p:outputPanel rendered="#{userSessionBean.selectedMenuItem.getBrowserSensitiveProperty('last_success_login_dt') != null and 
                                         userSessionBean.lastSuccessLoginDateTime != null and userSessionBean.loginMethod == 'PASSWORD'}"
                             styleClass="justify-content-center">
                <sf:outputText value="#{userSessionBean.selectedMenuItem.getBrowserSensitiveProperty('last_success_login_dt')}" 
                               translator="#{userSessionBean.translator}" 
                               translationGroup="login" />
                <h:outputText value="#{userSessionBean.lastSuccessLoginDateTime}" style="margin-left: 2px;">
                  <f:converter converterId="DateTimeConverter" />
                  <f:attribute name="userFormat" value="dd/MM/yyyy HH:mm:ss" />
                </h:outputText>
              </p:outputPanel> 
            </p:tooltip>                
            <p:commandButton action="#{loginBean.logout}" icon="pi pi-fw pi-sign-out" 
                             title="#{webBundle.buttonSignout}" alt="#{webBundle.buttonSignout}"
                             styleClass="mx-2" immediate="true">
            </p:commandButton>                                    
          </div>                     
        </f:facet>
      </p:menubar>
    </p:outputPanel>

    <div class="template-layout flex">

      <!-- Vertical menu -->
      <p:outputPanel id="vertical_menu" class="lg:flex hidden">
        <div id="left_button_bar" class="flex flex-row lg:flex-column align-items-center w-12 py-3 pl-2"  > 
          <p:repeat value="#{templateBacking.leftMenuItems}" var="leftMenuItem">
            <p:linkButton href="#{leftMenuItem.getUrl()}" onclick="#{leftMenuItem.getOnclick()}" 
                          icon="#{leftMenuItem.getIcon()} mi-invert-color" value="#{leftMenuItem.getTitle()}" 
                          styleClass="ui-button-raised my-1" />
          </p:repeat>
        </div>  
      </p:outputPanel>

      <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
      <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>  

      <div class="col flex slick-columns" style="width: 100%" >
        <!-- Left column -->
        <p:outputPanel id="left_column" style="width:18%;height: 100%" class="m-1 pb-2 overflow-auto">           
          <ui:insert name="left_column"></ui:insert>
        </p:outputPanel>

        <!-- Central column -->
        <p:outputPanel id="central_column"  style="width:62%" class="flex-grow-1 overflow-auto m-1">
          <ui:insert name="body"></ui:insert>
        </p:outputPanel>

        <!-- Right column -->
        <p:outputPanel id="right_column" style="width: 18%" class="m-1 pb-2">
          <ui:insert name="right_column"></ui:insert>             
        </p:outputPanel>
      </div>

      <script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
      <script src="/templates/pf_3cols/template.js"></script>   

    </div>

  </ui:define>

</ui:composition>



